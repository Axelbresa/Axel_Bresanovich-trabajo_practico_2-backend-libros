const formEditarAutor = document.querySelector('#formEditarAutor');
//const _id = "6528104958e85c3ae43a1264";

const id = document.querySelector("#id");
const nombre = document.querySelector("#nombre");
const apellido = document.querySelector("#apellido");
const bibliografia = document.querySelector("#bibliografia");

// Agrega otros campos de edición de autor aquí

document.addEventListener('DOMContentLoaded', async () => {
    const response = await fetch(`/editar_autor/${_id.id}`);
    const data = await response.json();

    id.value = data.id;
    nombre.value = data.nombre;
    apellido.value = data.apellido;
    bibliografia.value = data.bibliografia;
});

formEditarAutor.addEventListener('submit', async (e) => {
    e.preventDefault();

    const autorActualizado = {
        id: id.value,
        nombre: nombre.value,
        apellido: apellido.value,
        bibliografia: bibliografia.value
        // Agrega otros campos de autor que desees actualizar
    };

    const response = await fetch(`/autor/:${_id}`, {
        method: 'PUT',
        body: JSON.stringify(autorActualizado),
        headers: {
            'Content-Type': 'application/json'
        }
    });

    const respToJson = await response.json();

    if (response.status !== 200) {
        return Swal.fire({
            title: 'Error',
            text: respToJson.message,
            icon: 'error',
            confirmButtonText: 'Aceptar'
        });
    };

    Swal.fire({
        title: 'Autor actualizado',
        text: respToJson.message,
        icon: 'success',
        confirmButtonText: 'Aceptar'
    });

    setTimeout(() => {
        window.location.href = "/"; // Redirigir al usuario a la página principal
    }, 2000);
});
